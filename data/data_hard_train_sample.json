[
    {
        "text": "Write a stored procedure in PLpgSQL to delete rows from the STUDENT table where the STU_HRS is less than para_STU_HRS and the STU_TRANSFER is equal to para_STU_TRANSFER. Then, open a cursor on the ENROLL table and loop through its records. For each record, update the STU_TRANSFER in the STUDENT table to para_STU_TRANSFER, and update the CLASS_CODE in the ENROLL table to para_CLASS_CODE.",
        "plsql": "CREATE OR REPLACE PROCEDURE sp(para_STU_HRS integer, para_STU_TRANSFER real, para_CLASS_CODE text) LANGUAGE plpgsql AS $$ DECLARE ref_cursor CURSOR FOR SELECT * FROM \"ENROLL\"; rec RECORD; BEGIN DELETE FROM \"STUDENT\" WHERE \"STU_HRS\" < para_STU_HRS and \"STU_TRANSFER\" = para_STU_TRANSFER; OPEN ref_cursor; LOOP FETCH ref_cursor INTO rec; EXIT WHEN NOT FOUND; UPDATE \"STUDENT\" SET \"STU_TRANSFER\" = para_STU_TRANSFER; UPDATE \"ENROLL\" SET \"CLASS_CODE\" = para_CLASS_CODE WHERE CURRENT OF ref_cursor; END LOOP; CLOSE ref_cursor; END; $$;",
        "call": [
            "call sp(81, 0.0, '10018');",
            "call sp(102, 0.0, '10014');",
            "call sp(102, 0.0, '10018');",
            "call sp(42, 0.0, '10014');",
            "call sp(15, 1.0, '10018');"
        ],
        "database": "college_1",
        "table": [
            "STUDENT",
            "ENROLL"
        ],
        "schema": {
            "schema_items": [
                {
                    "table_name": "PROFESSOR",
                    "table_comment": "",
                    "column_names": [
                        "EMP_NUM",
                        "DEPT_CODE",
                        "PROF_OFFICE",
                        "PROF_EXTENSION",
                        "PROF_HIGH_DEGREE"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "text",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            228,
                            155
                        ],
                        [
                            "ENG",
                            "ENG"
                        ],
                        [
                            "KLR 333",
                            "AAK 194"
                        ],
                        [
                            "4440",
                            "4436"
                        ],
                        [
                            "MA",
                            "Ph.D."
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "CLASS",
                    "table_comment": "",
                    "column_names": [
                        "CLASS_CODE",
                        "CRS_CODE",
                        "CLASS_SECTION",
                        "CLASS_TIME",
                        "CLASS_ROOM",
                        "PROF_NUM"
                    ],
                    "column_types": [
                        "text",
                        "text",
                        "text",
                        "text",
                        "text",
                        "integer"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            "10020",
                            "10014"
                        ],
                        [
                            "CIS-220",
                            "QM-261"
                        ],
                        [
                            "3",
                            "2"
                        ],
                        [
                            "MWF 11:00-11:50 a.m.",
                            "MWF 8:00-8:50 a.m."
                        ],
                        [
                            "BUS252",
                            "BUS311"
                        ],
                        [
                            228,
                            301
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "COURSE",
                    "table_comment": "",
                    "column_names": [
                        "CRS_CODE",
                        "DEPT_CODE",
                        "CRS_DESCRIPTION",
                        "CRS_CREDIT"
                    ],
                    "column_types": [
                        "text",
                        "text",
                        "text",
                        "real"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            "ACCT-212",
                            "CIS-220"
                        ],
                        [
                            "CIS",
                            "CIS"
                        ],
                        [
                            "Database Design and Implementation",
                            "Accounting I"
                        ],
                        [
                            4.0,
                            4.0
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "DEPARTMENT",
                    "table_comment": "",
                    "column_names": [
                        "DEPT_CODE",
                        "DEPT_NAME",
                        "SCHOOL_CODE",
                        "EMP_NUM",
                        "DEPT_ADDRESS",
                        "DEPT_EXTENSION"
                    ],
                    "column_types": [
                        "text",
                        "text",
                        "text",
                        "integer",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            "HIST",
                            "ACCT"
                        ],
                        [
                            "Fine Arts",
                            "Economics/Finance"
                        ],
                        [
                            "A&SCI",
                            "A&SCI"
                        ],
                        [
                            195,
                            297
                        ],
                        [
                            "KLR 211, Box 52",
                            "AAK 194, Box 422"
                        ],
                        [
                            "4117",
                            "3126"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "EMPLOYEE",
                    "table_comment": "",
                    "column_names": [
                        "EMP_NUM",
                        "EMP_LNAME",
                        "EMP_FNAME",
                        "EMP_INITIAL",
                        "EMP_JOBCODE",
                        "EMP_HIREinteger",
                        "EMP_DOB"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            106,
                            104
                        ],
                        [
                            "Heffington",
                            "Williamson"
                        ],
                        [
                            "Jill",
                            "Ronald"
                        ],
                        [
                            "T",
                            ""
                        ],
                        [
                            "PROF",
                            "CLRK"
                        ],
                        [
                            "1992-5-1",
                            "1989-8-1"
                        ],
                        [
                            "1961-6-20",
                            "1941-3-4"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "ENROLL",
                    "table_comment": "",
                    "column_names": [
                        "CLASS_CODE",
                        "STU_NUM",
                        "ENROLL_GRADE"
                    ],
                    "column_types": [
                        "text",
                        "integer",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            "10018",
                            "10018"
                        ],
                        [
                            321452,
                            321452
                        ],
                        [
                            "C",
                            "C"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "STUDENT",
                    "table_comment": "",
                    "column_names": [
                        "STU_NUM",
                        "STU_LNAME",
                        "STU_FNAME",
                        "STU_INIT",
                        "STU_DOB",
                        "STU_HRS",
                        "STU_CLASS",
                        "STU_GPA",
                        "STU_TRANSFER",
                        "DEPT_CODE",
                        "STU_PHONE",
                        "PROF_NUM"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "text",
                        "text",
                        "text",
                        "integer",
                        "text",
                        "real",
                        "real",
                        "text",
                        "text",
                        "integer"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            324273,
                            324258
                        ],
                        [
                            "Smith",
                            "Brewer"
                        ],
                        [
                            "John",
                            "William"
                        ],
                        [
                            "D",
                            "C"
                        ],
                        [
                            "1958-12-30",
                            "1975-2-12"
                        ],
                        [
                            102,
                            120
                        ],
                        [
                            "Jr",
                            "Jr"
                        ],
                        [
                            2.11,
                            2.84
                        ],
                        [
                            0.0,
                            0.0
                        ],
                        [
                            "ACCT",
                            "CIS"
                        ],
                        [
                            "2256",
                            "2256"
                        ],
                        [
                            311,
                            205
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                }
            ],
            "foreign_keys": []
        },
        "evidence": "",
        "table_labels": [
            0,
            0,
            0,
            0,
            0,
            1,
            1
        ],
        "column_labels": [
            [
                0,
                0,
                0,
                0,
                0
            ],
            [
                1,
                0,
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0,
                0,
                0,
                0
            ],
            [
                1,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                0,
                1,
                0,
                0,
                0
            ]
        ],
        "matched_contents": {},
        "skeleton": "CREATE OR REPLACE PROCEDURE sp(_ _, _ _, _ _) LANGUAGE plpgsql AS $$ DECLARE ref_cursor CURSOR FOR SELECT * FROM _; rec RECORD; BEGIN DELETE FROM _ WHERE _ < _ and _ = _; OPEN ref_cursor; LOOP FETCH ref_cursor INTO rec; EXIT WHEN NOT FOUND; UPDATE _ SET _ = _; UPDATE _ SET _ = _ WHERE CURRENT OF ref_cursor; END LOOP; CLOSE ref_cursor; END; $$;",
        "insert": 0,
        "update": 1,
        "delete": 1,
        "if": 0,
        "loop": 1
    },
    {
        "text": "Write a stored procedure in PLpgSQL that declares a cursor to select all records from the Department table. Update the Room column in the Department table to the value of para_Room for rows where Room is greater than para_Room. Open the cursor and iterate through each record, updating the Building column to para_Building for the current row in the cursor. After processing all records, close the cursor.",
        "plsql": "CREATE OR REPLACE PROCEDURE sp(para_DNO integer, para_Room text, para_Building text) LANGUAGE plpgsql AS $$ DECLARE ref_cursor CURSOR FOR SELECT * FROM \"Department\"; rec RECORD; BEGIN UPDATE \"Department\" SET \"Room\" = para_Room WHERE \"Room\" > para_Room; OPEN ref_cursor; LOOP FETCH ref_cursor INTO rec; EXIT WHEN NOT FOUND; UPDATE \"Department\" SET \"Building\" = para_Building WHERE CURRENT OF ref_cursor; END LOOP; CLOSE ref_cursor; END; $$; ",
        "call": [
            "call sp(30, '312', 'Mergenthaler');",
            "call sp(110, '245', 'Remsen');",
            "call sp(180, '221', 'Gilman');",
            "call sp(40, '121', 'Gilman');",
            "call sp(140, '440', 'Macaulay');"
        ],
        "database": "college_3",
        "table": [
            "Department"
        ],
        "schema": {
            "schema_items": [
                {
                    "table_name": "Member_of",
                    "table_comment": "",
                    "column_names": [
                        "FacID",
                        "DNO",
                        "Appt_Type"
                    ],
                    "column_types": [
                        "integer",
                        "integer",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            8741,
                            9811
                        ],
                        [
                            600,
                            600
                        ],
                        [
                            "Primary",
                            "Primary"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "Course",
                    "table_comment": "",
                    "column_names": [
                        "CID",
                        "CName",
                        "Credits",
                        "Instructor",
                        "Days",
                        "Hours",
                        "DNO"
                    ],
                    "column_types": [
                        "text",
                        "text",
                        "integer",
                        "integer",
                        "text",
                        "text",
                        "integer"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            "600.101",
                            "600.227"
                        ],
                        [
                            "DISTRIBUTED SYSTEMS",
                            "COMPUTER SYSTEM FUNDAMENTALS"
                        ],
                        [
                            3,
                            3
                        ],
                        [
                            6112,
                            6112
                        ],
                        [
                            "Th",
                            "MTW"
                        ],
                        [
                            "3",
                            "3"
                        ],
                        [
                            600,
                            600
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "Department",
                    "table_comment": "",
                    "column_names": [
                        "DNO",
                        "Division",
                        "DName",
                        "Room",
                        "Building",
                        "DPhone"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "text",
                        "text",
                        "text",
                        "integer"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            50,
                            520
                        ],
                        [
                            "AS",
                            "EN"
                        ],
                        [
                            "Classics",
                            "Physics and Astronomy"
                        ],
                        [
                            "404B",
                            "121"
                        ],
                        [
                            "Gilman",
                            "Mergenthaler"
                        ],
                        [
                            7330,
                            7117
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "Enrolled_in",
                    "table_comment": "",
                    "column_names": [
                        "StuID",
                        "CID",
                        "Grade"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            1003,
                            1001
                        ],
                        [
                            "600.333",
                            "600.463"
                        ],
                        [
                            "B",
                            "B+"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "Faculty",
                    "table_comment": "",
                    "column_names": [
                        "FacID",
                        "Lname",
                        "Fname",
                        "Rank",
                        "Sex",
                        "Phone",
                        "Room",
                        "Building"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "text",
                        "text",
                        "text",
                        "integer",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            1193,
                            2119
                        ],
                        [
                            "Scheinerman",
                            "Giuliano"
                        ],
                        [
                            "Alan",
                            "Gerald"
                        ],
                        [
                            "Professor",
                            "AsstProf"
                        ],
                        [
                            "M",
                            "M"
                        ],
                        [
                            6654,
                            6953
                        ],
                        [
                            "119",
                            "288"
                        ],
                        [
                            "Barton",
                            "Krieger"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "Minor_in",
                    "table_comment": "",
                    "column_names": [
                        "StuID",
                        "DNO"
                    ],
                    "column_types": [
                        "integer",
                        "integer"
                    ],
                    "column_comments": [
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            1027,
                            1016
                        ],
                        [
                            140,
                            90
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0
                    ]
                },
                {
                    "table_name": "Gradeconversion",
                    "table_comment": "",
                    "column_names": [
                        "lettergrade",
                        "gradepoint"
                    ],
                    "column_types": [
                        "text",
                        "real"
                    ],
                    "column_comments": [
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            "C-",
                            "D+"
                        ],
                        [
                            2.7,
                            2.0
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0
                    ]
                },
                {
                    "table_name": "Student",
                    "table_comment": "",
                    "column_names": [
                        "StuID",
                        "LName",
                        "Fname",
                        "Age",
                        "Sex",
                        "Major",
                        "Advisor",
                        "city_code"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "text",
                        "integer",
                        "text",
                        "integer",
                        "integer",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            1018,
                            1006
                        ],
                        [
                            "Norris",
                            "Pang"
                        ],
                        [
                            "Paul",
                            "Dinesh"
                        ],
                        [
                            22,
                            20
                        ],
                        [
                            "M",
                            "M"
                        ],
                        [
                            600,
                            600
                        ],
                        [
                            7712,
                            7723
                        ],
                        [
                            "PIT",
                            "NYC"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                }
            ],
            "foreign_keys": []
        },
        "evidence": "",
        "table_labels": [
            0,
            0,
            1,
            0,
            0,
            0,
            0,
            0
        ],
        "column_labels": [
            [
                0,
                1,
                0
            ],
            [
                0,
                0,
                0,
                0,
                0,
                0,
                1
            ],
            [
                1,
                0,
                0,
                1,
                1,
                0
            ],
            [
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0,
                0,
                0,
                1,
                1
            ],
            [
                0,
                1
            ],
            [
                0,
                0
            ],
            [
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
            ]
        ],
        "matched_contents": {},
        "skeleton": "CREATE OR REPLACE PROCEDURE sp(_ _, _ _, _ _) LANGUAGE plpgsql AS $$ DECLARE ref_cursor CURSOR FOR SELECT * FROM _; rec RECORD; BEGIN UPDATE _ SET _ = _ WHERE _ > _; OPEN ref_cursor; LOOP FETCH ref_cursor INTO rec; EXIT WHEN NOT FOUND; UPDATE _ SET _ = _ WHERE CURRENT OF ref_cursor; END LOOP; CLOSE ref_cursor; END; $$; ",
        "insert": 0,
        "update": 1,
        "delete": 0,
        "if": 0,
        "loop": 1
    },
    {
        "text": "Create a stored procedure in PLpgSQL that first updates the Grape column in the wine table to para_Grape for rows where Grape is greater than para_Grape, then uses a cursor to iterate over all records in the wine table to update the Winery column to para_Winery for each row accessed by the cursor.",
        "plsql": "CREATE OR REPLACE PROCEDURE sp(para_Cases integer, para_Grape text, para_Winery text) LANGUAGE plpgsql AS $$ DECLARE ref_cursor CURSOR FOR SELECT * FROM \"wine\"; rec RECORD; BEGIN UPDATE \"wine\" SET \"Grape\" = para_Grape WHERE \"Grape\" > para_Grape; OPEN ref_cursor; LOOP FETCH ref_cursor INTO rec; EXIT WHEN NOT FOUND; UPDATE \"wine\" SET \"Winery\" = para_Winery WHERE CURRENT OF ref_cursor; END LOOP; CLOSE ref_cursor; END; $$; ",
        "call": [
            "call sp(1500, 'Sauvignon Blanc', 'Brander');",
            "call sp(354, 'Sauvignon Blanc', 'Robert Biale');",
            "call sp(370, 'Sauvignon Blanc', 'Peter Michael');",
            "call sp(275, 'Zinfandel', 'Grey Stack');",
            "call sp(377, 'Sauvignon Blanc', 'Pedroncelli');"
        ],
        "database": "wine_1",
        "table": [
            "wine"
        ],
        "schema": {
            "schema_items": [
                {
                    "table_name": "appellations",
                    "table_comment": "",
                    "column_names": [
                        "No",
                        "Appelation",
                        "County",
                        "State",
                        "Area",
                        "isAVA"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            4,
                            14
                        ],
                        [
                            "Guenoc Valley",
                            "Amador-Mendocino-Sonoma Counties"
                        ],
                        [
                            "San Luis Obispo",
                            "Sonoma"
                        ],
                        [
                            "California",
                            "California"
                        ],
                        [
                            "North Coast",
                            "N/A"
                        ],
                        [
                            "No",
                            "Yes"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "grapes",
                    "table_comment": "",
                    "column_names": [
                        "ID",
                        "Grape",
                        "Color"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            4,
                            1
                        ],
                        [
                            "Zinfandel",
                            "Viognier"
                        ],
                        [
                            "Red",
                            "Red"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "wine",
                    "table_comment": "",
                    "column_names": [
                        "No",
                        "Grape",
                        "Winery",
                        "Appelation",
                        "State",
                        "Name",
                        "Year",
                        "Price",
                        "Score",
                        "Cases",
                        "Drink"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text",
                        "integer",
                        "integer",
                        "integer",
                        "integer",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            13,
                            19
                        ],
                        [
                            "Zinfandel",
                            "Sauvignon Blanc"
                        ],
                        [
                            "Jericho Canyon",
                            "Peter Michael"
                        ],
                        [
                            "Napa Valley",
                            "Bennett Valley"
                        ],
                        [
                            "California",
                            "California"
                        ],
                        [
                            "Les Pionniers",
                            "Church Vineyard"
                        ],
                        [
                            2009,
                            2009
                        ],
                        [
                            28,
                            44
                        ],
                        [
                            89,
                            89
                        ],
                        [
                            700,
                            377
                        ],
                        [
                            "now",
                            "now"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                }
            ],
            "foreign_keys": []
        },
        "evidence": "",
        "table_labels": [
            0,
            0,
            1
        ],
        "column_labels": [
            [
                0,
                0,
                0,
                0,
                0,
                0
            ],
            [
                0,
                1,
                0
            ],
            [
                0,
                1,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                1,
                0
            ]
        ],
        "matched_contents": {},
        "skeleton": "CREATE OR REPLACE PROCEDURE sp(_ _, _ _, _ _) LANGUAGE plpgsql AS $$ DECLARE ref_cursor CURSOR FOR SELECT * FROM _; rec RECORD; BEGIN UPDATE _ SET _ = _ WHERE _ > _; OPEN ref_cursor; LOOP FETCH ref_cursor INTO rec; EXIT WHEN NOT FOUND; UPDATE _ SET _ = _ WHERE CURRENT OF ref_cursor; END LOOP; CLOSE ref_cursor; END; $$; ",
        "insert": 0,
        "update": 1,
        "delete": 0,
        "if": 0,
        "loop": 1
    },
    {
        "text": "Create a stored procedure in PLpgSQL that first inserts para_friend and para_year into the friend and year columns of the PersonFriend table. Then, for each record in the Person table, update the job column to para_job using a cursor. Finally, update the age column in the Person where the job value equals para_job.",
        "plsql": "CREATE OR REPLACE PROCEDURE sp(para_friend text, para_year integer, para_job text, para_age integer) LANGUAGE plpgsql AS $$ DECLARE ref_cursor CURSOR FOR SELECT * FROM \"Person\"; rec RECORD; BEGIN INSERT INTO \"PersonFriend\" (\"friend\", \"year\") VALUES (para_friend, para_year); OPEN ref_cursor; LOOP FETCH ref_cursor INTO rec; EXIT WHEN NOT FOUND; UPDATE \"Person\" SET \"job\" = para_job WHERE CURRENT OF ref_cursor; END LOOP; CLOSE ref_cursor; UPDATE \"Person\" SET \"age\" = para_age WHERE \"job\" = para_job; END; $$;",
        "call": [
            "call sp('Alice', 6, 'doctor', 26);",
            "call sp('Alice', 10, 'doctor', 25);",
            "call sp('Alice', 10, 'doctor', 26);",
            "call sp('Zach', 5, 'student', 26);",
            "call sp('Dan', 10, 'student', 26);"
        ],
        "database": "network_2",
        "table": [
            "PersonFriend",
            "Person"
        ],
        "schema": {
            "schema_items": [
                {
                    "table_name": "Person",
                    "table_comment": "",
                    "column_names": [
                        "name",
                        "age",
                        "city",
                        "gender",
                        "job"
                    ],
                    "column_types": [
                        "text",
                        "integer",
                        "text",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            "Alice",
                            "Bob"
                        ],
                        [
                            26,
                            45
                        ],
                        [
                            "new york city",
                            "chicago"
                        ],
                        [
                            "male",
                            "male"
                        ],
                        [
                            "doctor",
                            "student"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "PersonFriend",
                    "table_comment": "",
                    "column_names": [
                        "name",
                        "friend",
                        "year"
                    ],
                    "column_types": [
                        "text",
                        "text",
                        "integer"
                    ],
                    "column_comments": [
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            "Zach",
                            "Zach"
                        ],
                        [
                            "Zach",
                            "Alice"
                        ],
                        [
                            5,
                            12
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0
                    ]
                }
            ],
            "foreign_keys": []
        },
        "evidence": "",
        "table_labels": [
            1,
            1
        ],
        "column_labels": [
            [
                0,
                1,
                0,
                0,
                1
            ],
            [
                0,
                1,
                1
            ]
        ],
        "matched_contents": {},
        "skeleton": "CREATE OR REPLACE PROCEDURE sp(_ _, _ _, _ _, _ _) LANGUAGE plpgsql AS $$ DECLARE ref_cursor CURSOR FOR SELECT * FROM _; rec RECORD; BEGIN INSERT INTO _ (_, _) VALUES (_, _); OPEN ref_cursor; LOOP FETCH ref_cursor INTO rec; EXIT WHEN NOT FOUND; UPDATE _ SET _ = _ WHERE CURRENT OF ref_cursor; END LOOP; CLOSE ref_cursor; UPDATE _ SET _ = _ WHERE _ = _; END; $$;",
        "insert": 1,
        "update": 1,
        "delete": 0,
        "if": 0,
        "loop": 1
    },
    {
        "text": "Write a PLpgSQL stored procedure that first checks if there is any row in the university table where the Founded column matches para_Founded. If such a row exists, update the Enrollment column with the value para_Enrollment for those rows. If no such row exists, insert a new row into the university table with para_Founded as the value for Founded and para_Enrollment as the value for Enrollment.",
        "plsql": "CREATE OR REPLACE PROCEDURE sp(para_Founded real, para_Enrollment real) LANGUAGE plpgsql AS $$ BEGIN IF EXISTS (SELECT 1 FROM \"university\" WHERE \"Founded\" = para_Founded) THEN UPDATE \"university\" SET \"Enrollment\" = para_Enrollment WHERE \"Founded\" = para_Founded; ELSE INSERT INTO \"university\" (\"Founded\", \"Enrollment\") VALUES (para_Founded, para_Enrollment); END IF; END; $$;",
        "call": [
            "call sp(1892.0, 2100.0);",
            "call sp(1743.0, 2100.0);",
            "call sp(1743.0, 2100.0);",
            "call sp(1766.0, 2100.0);",
            "call sp(1957.0, 2100.0);"
        ],
        "database": "university_basketball",
        "table": [
            "university"
        ],
        "schema": {
            "schema_items": [
                {
                    "table_name": "basketball_match",
                    "table_comment": "",
                    "column_names": [
                        "Team_ID",
                        "School_ID",
                        "Team_Name",
                        "ACC_Regular_Season",
                        "ACC_Percent",
                        "ACC_Home",
                        "ACC_Road",
                        "All_Games",
                        "All_Games_Percent",
                        "All_Home",
                        "All_Road",
                        "All_Neutral"
                    ],
                    "column_types": [
                        "integer",
                        "integer",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text",
                        "integer",
                        "text",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            1,
                            3
                        ],
                        [
                            4,
                            2
                        ],
                        [
                            "Clemson",
                            "Virginia Tech"
                        ],
                        [
                            "13–3",
                            "9–7"
                        ],
                        [
                            ".563",
                            ".563"
                        ],
                        [
                            "6–2",
                            "7–1"
                        ],
                        [
                            "8–0",
                            "6–2"
                        ],
                        [
                            "21–14",
                            "24–10"
                        ],
                        [
                            1,
                            1
                        ],
                        [
                            "15–1",
                            "14–3"
                        ],
                        [
                            "4–8",
                            "13–0"
                        ],
                        [
                            "4–3",
                            "4–3"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "university",
                    "table_comment": "",
                    "column_names": [
                        "School_ID",
                        "School",
                        "Location",
                        "Founded",
                        "Affiliation",
                        "Enrollment",
                        "Nickname",
                        "Primary_conference"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "text",
                        "real",
                        "text",
                        "real",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            2,
                            3
                        ],
                        [
                            "Lebanon Valley College",
                            "University of Rhode Island"
                        ],
                        [
                            "New Brunswick, NJ",
                            "Newark, DE"
                        ],
                        [
                            1892.0,
                            1766.0
                        ],
                        [
                            "Public",
                            "Private/Methodist"
                        ],
                        [
                            2100.0,
                            19067.0
                        ],
                        [
                            "Seawolves",
                            "Flying Dutchmen"
                        ],
                        [
                            "American Athletic Conference ( D-I )",
                            "Atlantic 10 Conference ( D-I )"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                }
            ],
            "foreign_keys": []
        },
        "evidence": "",
        "table_labels": [
            0,
            1
        ],
        "column_labels": [
            [
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                1,
                0,
                1,
                0,
                0
            ]
        ],
        "matched_contents": {},
        "skeleton": "CREATE OR REPLACE PROCEDURE sp(_ _, _ _) LANGUAGE plpgsql AS $$ BEGIN IF EXISTS (SELECT 1 FROM _ WHERE _ = _) THEN UPDATE _ SET _ = _ WHERE _ = _; ELSE INSERT INTO _ (_, _) VALUES (_, _); END IF; END; $$;",
        "insert": 1,
        "update": 1,
        "delete": 0,
        "if": 1,
        "loop": 0
    },
    {
        "text": "Create a stored procedure in PLpgSQL to declare a cursor for selecting all records from the Likes where the value in the student_id column is greater than para_student_id. For each record fetched by the cursor, update the liked_id column to para_liked_id.",
        "plsql": "CREATE OR REPLACE PROCEDURE sp(para_student_id integer, para_liked_id integer) LANGUAGE plpgsql AS $$ DECLARE ref_cursor CURSOR FOR SELECT * FROM \"Likes\" WHERE \"student_id\" > para_student_id; rec RECORD; BEGIN OPEN ref_cursor; LOOP FETCH ref_cursor INTO rec; EXIT WHEN NOT FOUND; UPDATE \"Likes\" SET \"liked_id\" = para_liked_id WHERE CURRENT OF ref_cursor; END LOOP; CLOSE ref_cursor; END; $$;",
        "call": [
            "call sp(1709, 1247);",
            "call sp(1709, 1247);",
            "call sp(1709, 1501);",
            "call sp(1911, 1304);",
            "call sp(1247, 1709);"
        ],
        "database": "network_1",
        "table": [
            "Likes"
        ],
        "schema": {
            "schema_items": [
                {
                    "table_name": "Friend",
                    "table_comment": "",
                    "column_names": [
                        "student_id",
                        "friend_id"
                    ],
                    "column_types": [
                        "integer",
                        "integer"
                    ],
                    "column_comments": [
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            1782,
                            1689
                        ],
                        [
                            1101,
                            1304
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0
                    ]
                },
                {
                    "table_name": "Highschooler",
                    "table_comment": "",
                    "column_names": [
                        "ID",
                        "name",
                        "grade"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "integer"
                    ],
                    "column_comments": [
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            1510,
                            1641
                        ],
                        [
                            "Jordan",
                            "Alexis"
                        ],
                        [
                            9,
                            9
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "Likes",
                    "table_comment": "",
                    "column_names": [
                        "student_id",
                        "liked_id"
                    ],
                    "column_types": [
                        "integer",
                        "integer"
                    ],
                    "column_comments": [
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            1247,
                            1709
                        ],
                        [
                            1501,
                            1247
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0
                    ]
                }
            ],
            "foreign_keys": []
        },
        "evidence": "",
        "table_labels": [
            0,
            0,
            1
        ],
        "column_labels": [
            [
                1,
                0
            ],
            [
                0,
                0,
                0
            ],
            [
                1,
                1
            ]
        ],
        "matched_contents": {},
        "skeleton": "CREATE OR REPLACE PROCEDURE sp(_ _, _ _) LANGUAGE plpgsql AS $$ DECLARE ref_cursor CURSOR FOR SELECT * FROM _ WHERE _ > _; rec RECORD; BEGIN OPEN ref_cursor; LOOP FETCH ref_cursor INTO rec; EXIT WHEN NOT FOUND; UPDATE _ SET _ = _ WHERE CURRENT OF ref_cursor; END LOOP; CLOSE ref_cursor; END; $$;",
        "insert": 0,
        "update": 1,
        "delete": 0,
        "if": 0,
        "loop": 1
    },
    {
        "text": "Write a stored procedure in PLpgSQL that checks if there's a row in the culture_company table where the Incorporated_in column equals para_Incorporated_in. If such a row exists, update the Group_Equity_Shareholding column to para_Group_Equity_Shareholding for that row. If no such row exists, insert a new row with Incorporated_in set to para_Incorporated_in and Group_Equity_Shareholding set to para_Group_Equity_Shareholding.",
        "plsql": "CREATE OR REPLACE PROCEDURE sp(para_Incorporated_in text, para_Group_Equity_Shareholding real) LANGUAGE plpgsql AS $$ BEGIN IF EXISTS (SELECT 1 FROM \"culture_company\" WHERE \"Incorporated_in\" = para_Incorporated_in) THEN UPDATE \"culture_company\" SET \"Group_Equity_Shareholding\" = para_Group_Equity_Shareholding WHERE \"Incorporated_in\" = para_Incorporated_in; ELSE INSERT INTO \"culture_company\" (\"Incorporated_in\", \"Group_Equity_Shareholding\") VALUES (para_Incorporated_in, para_Group_Equity_Shareholding); END IF; END; $$;",
        "call": [
            "call sp('Hong Kong', 100.0);",
            "call sp('China', 18.77);",
            "call sp('China', 60.0);",
            "call sp('China', 49.0);",
            "call sp('Hong Kong', 18.77);"
        ],
        "database": "culture_company",
        "table": [
            "culture_company"
        ],
        "schema": {
            "schema_items": [
                {
                    "table_name": "book_club",
                    "table_comment": "",
                    "column_names": [
                        "book_club_id",
                        "Year",
                        "Author_or_Editor",
                        "Book_Title",
                        "Publisher",
                        "Category",
                        "Result"
                    ],
                    "column_types": [
                        "integer",
                        "integer",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            7,
                            4
                        ],
                        [
                            1989,
                            1989
                        ],
                        [
                            "Thom Nickels",
                            "Sandy Bayer"
                        ],
                        [
                            "Obedience",
                            "Heavy Gilt"
                        ],
                        [
                            "Crossing Press",
                            "Mysterious Press"
                        ],
                        [
                            "Lesb. M/SF",
                            "Gay M/SF"
                        ],
                        [
                            "Won",
                            "Nom"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "culture_company",
                    "table_comment": "",
                    "column_names": [
                        "Company_name",
                        "Type",
                        "Incorporated_in",
                        "Group_Equity_Shareholding",
                        "book_club_id",
                        "movie_id"
                    ],
                    "column_types": [
                        "text",
                        "text",
                        "text",
                        "real",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            "Cathay Pacific Culture",
                            "Dragonair"
                        ],
                        [
                            "Joint Venture",
                            "Joint Venture"
                        ],
                        [
                            "Hong Kong",
                            "China"
                        ],
                        [
                            49.0,
                            60.0
                        ],
                        [
                            "1",
                            "2"
                        ],
                        [
                            "3",
                            "2"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "movie",
                    "table_comment": "",
                    "column_names": [
                        "movie_id",
                        "Title",
                        "Year",
                        "Director",
                        "Budget_million",
                        "Gross_worldwide"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "integer",
                        "text",
                        "real",
                        "integer"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            10,
                            7
                        ],
                        [
                            "The Whole Nine Yards",
                            "Jill Rips"
                        ],
                        [
                            2000,
                            1999
                        ],
                        [
                            "Roger Christian",
                            "John Swanbeck"
                        ],
                        [
                            4.0,
                            7.0
                        ],
                        [
                            18720175,
                            3728888
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                }
            ],
            "foreign_keys": []
        },
        "evidence": "",
        "table_labels": [
            0,
            1,
            0
        ],
        "column_labels": [
            [
                0,
                0,
                0,
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                1,
                1,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0,
                0,
                0
            ]
        ],
        "matched_contents": {},
        "skeleton": "CREATE OR REPLACE PROCEDURE sp(_ _, _ _) LANGUAGE plpgsql AS $$ BEGIN IF EXISTS (SELECT 1 FROM _ WHERE _ = _) THEN UPDATE _ SET _ = _ WHERE _ = _; ELSE INSERT INTO _ (_, _) VALUES (_, _); END IF; END; $$;",
        "insert": 1,
        "update": 1,
        "delete": 0,
        "if": 1,
        "loop": 0
    },
    {
        "text": "Create or replace a stored procedure in PLpgSQL with a cursor that selects all records from the city table where the Black column value is greater than para_Black. Inside the procedure, delete records from the city table where Black is greater than para_Black and Hispanic is less than or equal to para_Hispanic. Then, iterate over the cursor, updating the County_ID column to para_County_ID and Multiracial column to para_Multiracial for the current record in the cursor loop.",
        "plsql": "CREATE OR REPLACE PROCEDURE sp(para_Black real, para_Hispanic real, para_County_ID integer, para_Multiracial real) LANGUAGE plpgsql AS $$ DECLARE ref_cursor CURSOR FOR SELECT * FROM \"city\" WHERE \"Black\" > para_Black; rec RECORD; BEGIN DELETE FROM \"city\" WHERE \"Black\" > para_Black AND \"Hispanic\" <= para_Hispanic; OPEN ref_cursor; LOOP FETCH ref_cursor INTO rec; EXIT WHEN NOT FOUND; UPDATE \"city\" SET \"County_ID\" = para_County_ID, \"Multiracial\" = para_Multiracial WHERE CURRENT OF ref_cursor; END LOOP; CLOSE ref_cursor; END; $$;",
        "call": [
            "call sp(4.1, 98.6, 1, 8.2);",
            "call sp(7.2, 99.0, 3, 7.7);",
            "call sp(11.0, 98.9, 3, 7.9);",
            "call sp(22.8, 99.3, 1, 11.7);",
            "call sp(7.4, 99.1, 5, 16.1);"
        ],
        "database": "county_public_safety",
        "table": [
            "city"
        ],
        "schema": {
            "schema_items": [
                {
                    "table_name": "city",
                    "table_comment": "",
                    "column_names": [
                        "City_ID",
                        "County_ID",
                        "Name",
                        "White",
                        "Black",
                        "Amerindian",
                        "Asian",
                        "Multiracial",
                        "Hispanic"
                    ],
                    "column_types": [
                        "integer",
                        "integer",
                        "text",
                        "real",
                        "real",
                        "real",
                        "real",
                        "real",
                        "real"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            7,
                            11
                        ],
                        [
                            1,
                            1
                        ],
                        [
                            "Aguadilla",
                            "Aguada"
                        ],
                        [
                            87.9,
                            72.5
                        ],
                        [
                            7.2,
                            22.8
                        ],
                        [
                            0.9,
                            0.4
                        ],
                        [
                            0.2,
                            0.1
                        ],
                        [
                            10.3,
                            10.7
                        ],
                        [
                            98.6,
                            99.4
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "county_public_safety",
                    "table_comment": "",
                    "column_names": [
                        "County_ID",
                        "Name",
                        "Population",
                        "Police_officers",
                        "Residents_per_officer",
                        "Case_burden",
                        "Crime_rate",
                        "Police_force",
                        "Location"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "integer",
                        "integer",
                        "integer",
                        "integer",
                        "real",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            5,
                            1
                        ],
                        [
                            "Campbell River",
                            "Chilliwack"
                        ],
                        [
                            16821,
                            16821
                        ],
                        [
                            11,
                            253
                        ],
                        [
                            803,
                            803
                        ],
                        [
                            137,
                            81
                        ],
                        [
                            278.0,
                            278.0
                        ],
                        [
                            "Central Saanich Police",
                            "RCMP"
                        ],
                        [
                            "West",
                            "West"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                }
            ],
            "foreign_keys": []
        },
        "evidence": "",
        "table_labels": [
            1,
            0
        ],
        "column_labels": [
            [
                0,
                1,
                0,
                0,
                1,
                0,
                0,
                1,
                1
            ],
            [
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
            ]
        ],
        "matched_contents": {},
        "skeleton": "CREATE OR REPLACE PROCEDURE sp(_ _, _ _, _ _, _ _) LANGUAGE plpgsql AS $$ DECLARE ref_cursor CURSOR FOR SELECT * FROM _ WHERE _ > _; rec RECORD; BEGIN DELETE FROM _ WHERE _ > _ AND _ <= _; OPEN ref_cursor; LOOP FETCH ref_cursor INTO rec; EXIT WHEN NOT FOUND; UPDATE _ SET _ = _, _ = _ WHERE CURRENT OF ref_cursor; END LOOP; CLOSE ref_cursor; END; $$;",
        "insert": 0,
        "update": 1,
        "delete": 1,
        "if": 0,
        "loop": 1
    },
    {
        "text": "Create a PL/pgSQL stored procedure that inserts a new record into the matches table with loser_age set to para_loser_age and winner_ioc set to para_winner_ioc. Then, open a cursor for selecting all rows from the rankings table and loop through each record; update the ranking_points of each fetched row to para_ranking_points. Finally, update the player_id column in the rankings table to para_player_id for any row where ranking_points equals para_ranking_points, and close the cursor.",
        "plsql": "CREATE OR REPLACE PROCEDURE sp(para_loser_age real, para_winner_ioc text, para_ranking_points integer, para_player_id integer) LANGUAGE plpgsql AS $$ DECLARE ref_cursor CURSOR FOR SELECT * FROM \"rankings\"; rec RECORD; BEGIN INSERT INTO \"matches\" (\"loser_age\", \"winner_ioc\") VALUES (para_loser_age, para_winner_ioc); OPEN ref_cursor; LOOP FETCH ref_cursor INTO rec; EXIT WHEN NOT FOUND; UPDATE \"rankings\" SET \"ranking_points\" = para_ranking_points WHERE CURRENT OF ref_cursor; END LOOP; CLOSE ref_cursor; UPDATE \"rankings\" SET \"player_id\" = para_player_id WHERE \"ranking_points\" = para_ranking_points; END; $$;",
        "call": [
            "call sp(26.480494, 'USA', 2, 200069);",
            "call sp(25.7577, 'FRA', 471, 200117);",
            "call sp(25.50308, 'CZE', 2, 201325);",
            "call sp(23.622177, 'CZE', 671, 200020);",
            "call sp(23.80835, 'BLR', 834, 200012);"
        ],
        "database": "wta_1",
        "table": [
            "matches",
            "rankings"
        ],
        "schema": {
            "schema_items": [
                {
                    "table_name": "matches",
                    "table_comment": "",
                    "column_names": [
                        "best_of",
                        "draw_size",
                        "loser_age",
                        "loser_entry",
                        "loser_hand",
                        "loser_ht",
                        "loser_id",
                        "loser_ioc",
                        "loser_name",
                        "loser_rank",
                        "loser_rank_points",
                        "loser_seed",
                        "match_num",
                        "minutes",
                        "round",
                        "score",
                        "surface",
                        "tourney_integer",
                        "tourney_id",
                        "tourney_level",
                        "tourney_name",
                        "winner_age",
                        "winner_entry",
                        "winner_hand",
                        "winner_ht",
                        "winner_id",
                        "winner_ioc",
                        "winner_name",
                        "winner_rank",
                        "winner_rank_points",
                        "winner_seed",
                        "year"
                    ],
                    "column_types": [
                        "integer",
                        "integer",
                        "real",
                        "text",
                        "text",
                        "integer",
                        "integer",
                        "text",
                        "text",
                        "integer",
                        "integer",
                        "integer",
                        "integer",
                        "integer",
                        "text",
                        "text",
                        "text",
                        "integer",
                        "text",
                        "text",
                        "text",
                        "real",
                        "text",
                        "text",
                        "integer",
                        "integer",
                        "text",
                        "text",
                        "integer",
                        "integer",
                        "integer",
                        "integer"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            3,
                            3
                        ],
                        [
                            4,
                            4
                        ],
                        [
                            25.483915,
                            26.480494
                        ],
                        [
                            "",
                            ""
                        ],
                        [
                            "R",
                            "R"
                        ],
                        [
                            184,
                            180
                        ],
                        [
                            201458,
                            201474
                        ],
                        [
                            "POL",
                            "POL"
                        ],
                        [
                            "Karolina Pliskova",
                            "Carla Suarez Navarro"
                        ],
                        [
                            4,
                            8
                        ],
                        [
                            2745,
                            5890
                        ],
                        [
                            9,
                            3
                        ],
                        [
                            221,
                            297
                        ],
                        [
                            100,
                            84
                        ],
                        [
                            "QF",
                            "R32"
                        ],
                        [
                            "6-4 6-3",
                            "6-7(3) 6-2 6-3"
                        ],
                        [
                            "Hard",
                            "Hard"
                        ],
                        [
                            20131021,
                            20131021
                        ],
                        [
                            "2013-W-WT-TUR-01A-2013",
                            "2013-W-WT-TUR-01A-2013"
                        ],
                        [
                            "W",
                            "W"
                        ],
                        [
                            "WTA Championships",
                            "Australian Open"
                        ],
                        [
                            32.068447,
                            32.068447
                        ],
                        [
                            "",
                            ""
                        ],
                        [
                            "R",
                            "L"
                        ],
                        [
                            168,
                            177
                        ],
                        [
                            201505,
                            201585
                        ],
                        [
                            "CHN",
                            "GER"
                        ],
                        [
                            "Alize Cornet",
                            "Angelique Kerber"
                        ],
                        [
                            2,
                            1
                        ],
                        [
                            2300,
                            5120
                        ],
                        [
                            4,
                            7
                        ],
                        [
                            2016,
                            2013
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "players",
                    "table_comment": "",
                    "column_names": [
                        "player_id",
                        "first_name",
                        "last_name",
                        "hand",
                        "birth_integer",
                        "country_code"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "text",
                        "text",
                        "integer",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            200001,
                            200005
                        ],
                        [
                            "Petra",
                            "Karina"
                        ],
                        [
                            "Sanchez Vicario",
                            "Hingis"
                        ],
                        [
                            "R",
                            "R"
                        ],
                        [
                            19750323,
                            19731122
                        ],
                        [
                            "ISR",
                            "SVK"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "rankings",
                    "table_comment": "",
                    "column_names": [
                        "ranking_integer",
                        "ranking",
                        "player_id",
                        "ranking_points",
                        "tours"
                    ],
                    "column_types": [
                        "integer",
                        "integer",
                        "integer",
                        "integer",
                        "integer"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            20000101,
                            20000101
                        ],
                        [
                            44,
                            45
                        ],
                        [
                            200020,
                            200012
                        ],
                        [
                            1,
                            629
                        ],
                        [
                            27,
                            16
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0
                    ]
                }
            ],
            "foreign_keys": []
        },
        "evidence": "",
        "table_labels": [
            1,
            0,
            1
        ],
        "column_labels": [
            [
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0
            ],
            [
                1,
                0,
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                1,
                1,
                0
            ]
        ],
        "matched_contents": {},
        "skeleton": "CREATE OR REPLACE PROCEDURE sp(_ _, _ _, _ _, _ _) LANGUAGE plpgsql AS $$ DECLARE ref_cursor CURSOR FOR SELECT * FROM _; rec RECORD; BEGIN INSERT INTO _ (_, _) VALUES (_, _); OPEN ref_cursor; LOOP FETCH ref_cursor INTO rec; EXIT WHEN NOT FOUND; UPDATE _ SET _ = _ WHERE CURRENT OF ref_cursor; END LOOP; CLOSE ref_cursor; UPDATE _ SET _ = _ WHERE _ = _; END; $$;",
        "insert": 1,
        "update": 1,
        "delete": 0,
        "if": 0,
        "loop": 1
    },
    {
        "text": "Write a PLpgSQL stored procedure that, in the Teachers, deletes rows where teacher_id is greater than para_teacher_id and email_address is less than or equal to para_email_address. Then, for each row in the Teachers where teacher_id is greater than para_teacher_id, update the cell_mobile_number column to para_cell_mobile_number and the gender column to para_gender using a cursor to fetch and loop through the records.",
        "plsql": "CREATE OR REPLACE PROCEDURE sp(para_teacher_id integer, para_email_address text, para_cell_mobile_number text, para_gender text) LANGUAGE plpgsql AS $$ DECLARE ref_cursor CURSOR FOR SELECT * FROM \"Teachers\" WHERE \"teacher_id\" > para_teacher_id; rec RECORD; BEGIN DELETE FROM \"Teachers\" WHERE \"teacher_id\" > para_teacher_id AND \"email_address\" <= para_email_address; OPEN ref_cursor; LOOP FETCH ref_cursor INTO rec; EXIT WHEN NOT FOUND; UPDATE \"Teachers\" SET \"cell_mobile_number\" = para_cell_mobile_number, \"gender\" = para_gender WHERE CURRENT OF ref_cursor; END LOOP; CLOSE ref_cursor; END; $$;",
        "call": [
            "call sp(9, 'everardo.lynch@example.net', '084-270-4880', '0');",
            "call sp(1, 'kozey.adeline@example.org', '599.373.0773x67706', '0');",
            "call sp(14, 'kiana.lang@example.net', '796-453-5175x64012', '0');",
            "call sp(5, 'valentina.yost@example.com', '599.373.0773x67706', '0');",
            "call sp(15, 'ierdman@example.com', '908-759-1808x63115', '1');"
        ],
        "database": "behavior_monitoring",
        "table": [
            "Teachers"
        ],
        "schema": {
            "schema_items": [
                {
                    "table_name": "Ref_Detention_Type",
                    "table_comment": "",
                    "column_names": [
                        "detention_type_code",
                        "detention_type_description"
                    ],
                    "column_types": [
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            "LUNCH",
                            "AFTER"
                        ],
                        [
                            "During Break time",
                            "During Break time"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0
                    ]
                },
                {
                    "table_name": "Addresses",
                    "table_comment": "",
                    "column_names": [
                        "address_id",
                        "line_1",
                        "line_2",
                        "line_3",
                        "city",
                        "zip_postcode",
                        "state_province_county",
                        "country",
                        "other_address_details"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            8,
                            14
                        ],
                        [
                            "3069 Garrison Squares",
                            "056 Murphy Stravenue Apt. 600"
                        ],
                        [
                            NaN,
                            NaN
                        ],
                        [
                            NaN,
                            NaN
                        ],
                        [
                            "Corkeryborough",
                            "Unachester"
                        ],
                        [
                            "238",
                            "748"
                        ],
                        [
                            "Arizona",
                            "Alabama"
                        ],
                        [
                            "USA",
                            "USA"
                        ],
                        [
                            NaN,
                            NaN
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "Assessment_Notes",
                    "table_comment": "",
                    "column_names": [
                        "notes_id",
                        "student_id",
                        "teacher_id",
                        "integer_of_notes",
                        "text_of_notes",
                        "other_details"
                    ],
                    "column_types": [
                        "integer",
                        "integer",
                        "integer",
                        "text",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            6,
                            5
                        ],
                        [
                            11,
                            4
                        ],
                        [
                            9,
                            3
                        ],
                        [
                            "1984-12-13 23:04:28",
                            "1988-04-11 04:56:26"
                        ],
                        [
                            NaN,
                            NaN
                        ],
                        [
                            NaN,
                            NaN
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "Behavior_Incident",
                    "table_comment": "",
                    "column_names": [
                        "incident_id",
                        "incident_type_code",
                        "student_id",
                        "integer_incident_start",
                        "integer_incident_end",
                        "incident_summary",
                        "recommendations",
                        "other_details"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "integer",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            13,
                            11
                        ],
                        [
                            "NOISE",
                            "NOISE"
                        ],
                        [
                            11,
                            1
                        ],
                        [
                            "2017-07-20 17:43:50",
                            "2017-05-25 15:02:53"
                        ],
                        [
                            "2018-03-02 16:06:34",
                            "2018-02-25 05:38:58"
                        ],
                        [
                            NaN,
                            NaN
                        ],
                        [
                            "Transfer schools",
                            "Transfer schools"
                        ],
                        [
                            NaN,
                            NaN
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "Detention",
                    "table_comment": "",
                    "column_names": [
                        "detention_id",
                        "detention_type_code",
                        "teacher_id",
                        "text_detention_start",
                        "text_detention_end",
                        "detention_summary",
                        "other_details"
                    ],
                    "column_types": [
                        "integer",
                        "text",
                        "integer",
                        "text",
                        "text",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            8,
                            7
                        ],
                        [
                            "LUNCH",
                            "BREAK "
                        ],
                        [
                            15,
                            14
                        ],
                        [
                            "2018-02-19 11:44:52",
                            "2017-10-30 16:04:00"
                        ],
                        [
                            "2018-03-08 02:08:32",
                            "2018-03-04 20:52:51"
                        ],
                        [
                            NaN,
                            NaN
                        ],
                        [
                            NaN,
                            NaN
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "Ref_Address_Types",
                    "table_comment": "",
                    "column_names": [
                        "address_type_code",
                        "address_type_description"
                    ],
                    "column_types": [
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            "HOME",
                            "HOME"
                        ],
                        [
                            "Billing",
                            "Billing"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0
                    ]
                },
                {
                    "table_name": "Ref_Incident_Type",
                    "table_comment": "",
                    "column_names": [
                        "incident_type_code",
                        "incident_type_description"
                    ],
                    "column_types": [
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            "VIOLENCE",
                            "VIOLENCE"
                        ],
                        [
                            "Disturbance",
                            "Disturbance"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0
                    ]
                },
                {
                    "table_name": "Students",
                    "table_comment": "",
                    "column_names": [
                        "student_id",
                        "address_id",
                        "first_name",
                        "middle_name",
                        "last_name",
                        "cell_mobile_number",
                        "email_address",
                        "integer_first_rental",
                        "integer_left_university",
                        "other_student_details"
                    ],
                    "column_types": [
                        "integer",
                        "integer",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            9,
                            7
                        ],
                        [
                            20,
                            9
                        ],
                        [
                            "Eugene",
                            "Antonietta"
                        ],
                        [
                            "Chesley",
                            "Lincoln"
                        ],
                        [
                            "Bergnaum",
                            "Balistreri"
                        ],
                        [
                            "(874)070-9495",
                            "(874)070-9495"
                        ],
                        [
                            "kkirlin@example.org",
                            "lisette.brekke@example.net"
                        ],
                        [
                            "2017-11-15 04:57:28",
                            "2018-01-11 19:49:39"
                        ],
                        [
                            "2018-03-12 15:05:53",
                            "2018-03-01 08:56:04"
                        ],
                        [
                            "first honor",
                            "first honor"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "Student_Addresses",
                    "table_comment": "",
                    "column_names": [
                        "student_id",
                        "address_id",
                        "integer_address_from",
                        "integer_address_to",
                        "monthly_rental",
                        "other_details"
                    ],
                    "column_types": [
                        "integer",
                        "integer",
                        "text",
                        "text",
                        "numeric",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            2,
                            8
                        ],
                        [
                            2,
                            9
                        ],
                        [
                            "2017-09-10 19:41:10",
                            "2018-01-12 13:23:23"
                        ],
                        [
                            "2018-03-15 10:37:19",
                            "2018-03-06 21:41:20"
                        ],
                        [
                            679.2988,
                            1297.3186
                        ],
                        [
                            "apartment",
                            "apartment"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "Students_in_Detention",
                    "table_comment": "",
                    "column_names": [
                        "student_id",
                        "detention_id",
                        "incident_id"
                    ],
                    "column_types": [
                        "integer",
                        "integer",
                        "integer"
                    ],
                    "column_comments": [
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            3,
                            10
                        ],
                        [
                            12,
                            14
                        ],
                        [
                            12,
                            13
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0
                    ]
                },
                {
                    "table_name": "Teachers",
                    "table_comment": "",
                    "column_names": [
                        "teacher_id",
                        "address_id",
                        "first_name",
                        "middle_name",
                        "last_name",
                        "gender",
                        "cell_mobile_number",
                        "email_address",
                        "other_details"
                    ],
                    "column_types": [
                        "integer",
                        "integer",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text",
                        "text"
                    ],
                    "column_comments": [
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        "",
                        ""
                    ],
                    "column_contents": [
                        [
                            6,
                            10
                        ],
                        [
                            12,
                            7
                        ],
                        [
                            "Cecilia",
                            "Trystan"
                        ],
                        [
                            "Keanu",
                            "Tamara"
                        ],
                        [
                            "Kuhic",
                            "Hansen"
                        ],
                        [
                            "0",
                            "1"
                        ],
                        [
                            "908-759-1808x63115",
                            "599.373.0773x67706"
                        ],
                        [
                            "kiana.lang@example.net",
                            "hilll.kitty@example.com"
                        ],
                        [
                            "Dean",
                            "Dean"
                        ]
                    ],
                    "pk_indicators": [
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0
                    ]
                }
            ],
            "foreign_keys": []
        },
        "evidence": "",
        "table_labels": [
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            1
        ],
        "column_labels": [
            [
                0,
                0
            ],
            [
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                1,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                1,
                0,
                0,
                0,
                0
            ],
            [
                0,
                0
            ],
            [
                0,
                0
            ],
            [
                0,
                0,
                0,
                0,
                0,
                1,
                1,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0,
                0,
                0,
                0
            ],
            [
                0,
                0,
                0
            ],
            [
                1,
                0,
                0,
                0,
                0,
                1,
                1,
                1,
                0
            ]
        ],
        "matched_contents": {},
        "skeleton": "CREATE OR REPLACE PROCEDURE sp(_ _, _ _, _ _, _ _) LANGUAGE plpgsql AS $$ DECLARE ref_cursor CURSOR FOR SELECT * FROM _ WHERE _ > _; rec RECORD; BEGIN DELETE FROM _ WHERE _ > _ AND _ <= _; OPEN ref_cursor; LOOP FETCH ref_cursor INTO rec; EXIT WHEN NOT FOUND; UPDATE _ SET _ = _, _ = _ WHERE CURRENT OF ref_cursor; END LOOP; CLOSE ref_cursor; END; $$;",
        "insert": 0,
        "update": 1,
        "delete": 1,
        "if": 0,
        "loop": 1
    }
]